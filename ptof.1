.TH PTOF 1 "July 1999" "pftools 2.2"
.SH NAME
ptof \- convert a protein profile into a frame-search profile  

.SH SYNOPSIS
.B ptof 
[ -r ] [ protein-profile ] [B=#] [F=#] [I=#] [X=#] [Y=#] [Z=#] 
.SH DESCRIPTION
.B ptof
converts a protein profile (generated for instance by pftools
programs 
.B pfmake, 
.B gtop
or
.B htop)
into a so-called "frame-search profile".
A frame-search profile is used to search an "interleaved frame-translated" DNA sequence
(generated by pftools program
.B 2ft)
for occurrences of a protein sequence motif.
An "interleaved frame-translated" DNA sequence
is an amino acid sequence corresponding to the 
.I N-2
overlapping codons of a DNA
sequence of length
.I N.
Note that in such a sequence, the character "O" is used to represent stop codons.

The conversion procedure works as follows: The protein profile is 
expanded in length by a factor of three to accommodate three translated
codons per original match position.
Two dummy match positions are placed between two consecutive significant match positions
imported from the original profile. 
The original insert positions are placed between pairs of adjacent dummy match positions.
The initiation, termination, and transition scores of the original insert
positions are left unchanged; the
insert extension scores are divided by a factor of 3, or by the value of the command-line
parameter 
.I I.  
The two insert positions flanking the significant match positions 
serve to accommodate frame-shift errors and introns, respectively.
The frame-shift insert position allows free insertion opening combined
with a high insert extension penalty (command-line parameter 
.I F) 
whereas the intron insertion position has high opening but low extension penalties
(command line parameters 
.I Y
and
.I Z).
The deletion opening and closing penalties next to the significant 
match positions are set to values that ensure that the total cost of a single-base
deletion is the same as the cost of  
a single base-insertion at a frame-shift insert position.
Furthermore, the alphabet of the original profile is extended by the stop codon symbol "O" 
which is assigned a constant negative value (command-line parameter
.I X)
at significant
match positions, and zero at dummy match positions. At insert positions, it is set to the
average of the other insert extension scores.
.SH OPTIONS
.TP
\-r
Frame-search parameters are given in normalized score units. This option
will only be considered if a linear normalization function with
priority over all other normalization functions is specified 
in the profile. 
In this case, the frame-search scores specified on the command line will be 
divided by the slope (R2 parameter) of the normalization
function. 
This option is particularly useful for profiles which are 
already scaled in units that can be interpreted as \(miLog(P)-values, 
.I e.g.
bits.  
.SH PARAMETERS
.TP
B=#
Minimal insertion and termination score. All internal and external
initiation and termination scores will be set to this 
value if the corresponding value in the original profile is lower than 
this value.
This parameter is used to impose a more
local alignment behavior on the frame-search profile in order to
deal with discontinuities in DNA sequences (long introns,
alternative splicing, chimeric clones, 
.I etc.)   
Default: B=\(mi50(\(mi0.5 with option -r).
.TP
F=#
Frame-shift error penalty. Default: F=\(mi100(\(mi1.0 with option -r). 
.TP
F=#
Insert score multiplier. The values of the original
insert extension scores will be multiplied by this
factor in order to compensate for the fact that 
a single amino acid corresponds to three overlapping
codon positions in the target sequence.
Default: I=1/3.
.TP
X=#
Stop codon penalty.
Default: X=\(mi100(\(mi1.0 with option -r)
.TP
Y=#
Intron opening penalty.
Default: Y=\(mi300(\(mi3.0 with option -r). 
.TP
Z=#
Intron extension penalty.
Default: Z=\(mi1(\(mi0.01 with option -r)
.SH EXAMPLES
.TP
(1)
.B ptof
-r sh3.prf F=\(mi1.2 I=0.6 X=\(mi1.5 B=\(mi0.5 > sh3.fsp
.br
.B 2ft
< R76849.seq | 
.B pfsearch 
-fy  sh3.fsp - C=5.0 

The protein domain profile in 
.I sh3.prf
is first converted into a frame-search profile 
.I sh3.fps.
Then both strands of the Fasta-formatted EST sequence in
.I R76849.seq
(GenBank/EMBL-accession: R76849) are converted into interleaved frame-translated
protein sequences and searched for SH3 domains with the frame-search profile 
generated in the preceding step.

The output may be compared to the result of a more conventional
search strategy using a protein profile in conjunction with a six-frame
translation of the same DNA sequence:

.B 6ft 
< R76849.seq | 
.B pfsearch 
-fy  sh3.prf - C=5.0 

.I See
also manual pages of
.B pfsearch,
.B 2ft
and 
.B 6ft.
.SH AUTHOR
.nf
Philipp Bucher
Philipp.Bucher@isrec.unil.ch
