.\"
.\" $Id: pfw.1,v 1.1 2003/05/12 11:50:03 vflegel Exp $
.\" Copyright (c) 2003 Swiss Institute of Bioinformatics <pftools@isb-sib.ch>
.\" Process this file with
.\" groff -man -Tascii <name>
.\" for ascii output or
.\" groff -man -Tps <name>
.\" for postscript output
.\"
.TH PFW 1 "May 2003" "pftools 2.3" "pftools"
.\" ------------------------------------------------
.\" Name section
.\" ------------------------------------------------
.SH NAME
pfw \- weight sequences of a multiple sequence alignment
.\" ------------------------------------------------
.\" Synopsis section
.\" ------------------------------------------------
.SH SYNOPSIS
.TP 10
.B pfw
[
.B \-hm
] [
.B \-N
.I shuffles
] [
.B \-R
.I seed
] [
.B \-W
.I weight
] [
.B \-X
.I gap_excision
] [
.I ms_file
|
.B \-
] [
.I parameters
]
.\" ------------------------------------------------
.\" Description section
.\" ------------------------------------------------
.SH DESCRIPTION
.B pfw 
computes new weights for individual sequences in a multiple sequence alignment
using the method of Sibbald and Argos (1990).
The file containing the multiple sequence alignment
.RI (' ms_file ')
must be either in MSF format as generated by
.SM GCG
programs or by
.B readseq
(checksums are ignored) or in MSA format as
produced by
.BR psa2msa (1).
If
.RB ' \- '
is specified instead of a filename, the multiple sequence alignment is read 
from the standard input.  
.B pfw
writes a new multiple sequence alignment with modified weights in either MSF or
MSA format to the standard output.
.\" ------------------------------------------------
.\" Options section
.\" ------------------------------------------------
.SH OPTIONS 
.\" --- ms_file ---
.TP
.I ms_file
Input multiple sequence alignment file.
.br
This file contains a multiple sequence alignment in either MSF (default) 
or MSA format. If the format is MSA,
.B pfw
will include the new weight of each sequence in the
.SM FASTA
header using the
.BR xpsa (5)
keyword
.IR weight .
It will thus replace any existing
.IR weight = value
pair in the header line.
If the filename is replaced by a
.RB ' \- ',
.B pfw
will read the multiple alignment from
.BR stdin .
.\" --- h ---
.TP
.B \-h
Display usage help text.
.\" --- m ---
.TP
.B \-m
Input multiple sequence alignment is in MSA format.
.\" --- N ---
.TP
.BI \-N\  shuffles
Number of shuffles per sequence to be performed.
.br
Note that an average relative precision of
.I r
percent is achieved by approximately
.RI (100/ r )-squared
shuffles.
.br
Type: integer
.br
Default: 100 (10% precision)
.\" --- R ---
.TP
.BI \-R\  seed
Seed for the random number generator.
.br
This must be a negative integer
(zero or positive integers will be reset to negative integers).
.br
Type: integer
.br
Default: -123456789 
.\" --- W ---
.TP
.BI \-W\  weight
Total weight.
.br
The initially computed weights will be multiplied by a constant
factor such that the sum of all weights equals this value. 
.br
Default: 1 
.\" --- X ---
.TP
.BI \-X\  gap_excision
Gap excision threshold.
.br
This is the minimal fraction of non-gap characters
a column of the multiple sequence alignment must contain 
in order to be considered for weighting.
.br
Default: 0.5 
.\" ------------------------------------------------
.\" Parameters section
.\" ------------------------------------------------
.SH PARAMETERS
.TP
Note:
for backwards compatibility, release 2.3 of the
.B pftools
package will parse the version 2.2 style parameters, but these are
.I deprecated
and the corresponding option (refer to the
.I options
section) should be used instead.
.TP
N=#
Shuffles per sequence.
.br
Use option
.B \-N
instead.
.TP
R=#
Random number seed.
.br
Use option
.B \-R
instead.
.TP
W=#
Total weight.
.br
Use option
.B \-W
instead.
.TP
X=#
Gap excision threshold.
.br
Use option
.B \-X
instead.
.\" ------------------------------------------------
.\" Exit code section
.\" ------------------------------------------------
.SH EXIT CODE
.LP
On successful completion of its task,
.B pfw
will return an exit code of 0. If an error occurs, a diagnostic message will be
output on standard error and the exit code will be different from 0. When conflicting
options where passed to the program but the task could nevertheless be completed, warnings
will be issued on standard error.
.\" ------------------------------------------------
.\" References section
.\" ------------------------------------------------
.SH REFERENCES
.LP
Sibbald PR & Argos P. (1990).
.I Weighting aligned protein or nucleic
.I acid sequences to correct for
.I unequal representation.
J. Mol. Biol.
.BR 216 :813-818.
.\" ------------------------------------------------
.\" See also section
.\" ------------------------------------------------
.SH "SEE ALSO"
.BR psa2msa (1),
.BR psa (5),
.BR xpsa (5)
.\" ------------------------------------------------
.\" Author section
.\" ------------------------------------------------
.SH AUTHOR
The
.B pftools
package was developped by Philipp Bucher.
.br
Any comments or suggestions should be addressed to <pftools@isb-sib.ch>.
