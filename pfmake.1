.TH PFMAKE 1 "February 1998" "pftools 2.1"
.SH NAME
pfmake \- generate a profile from a multiple sequence alignment 
.SH SYNOPSIS
.LP
.nf
\fBpfmake\fP [ -0123abes ] [ msf-file | - ] score-matrix [E=#] [F=#] [G=#]
           [H=#] [I=#] [L=#] [M=#] [S=#] [T=#] [X=#] 
.fi
.SH DESCRIPTION
.B pfmake
generates a PROSITE profile from a multiple sequence alignment using methods
described by Gribskov et al. (1990), Luethy et al. (1994),
and Thompson et al. (1994), with modifications to exploit the features of the
new profile format. The file containing the multiple sequence alignment (msf-file) must be
in MSF format as generated by GCG programs or by readseq (checksums are ignored).
The score-matrix file must also be in GCG format. 
If `-' is specified instead
of a real filename, the multiple sequence alignment is read
from the standard input.
The profile is written to the standard output. 

Alignment mode and accessories:
The disjointness definition is set to PROTECT with borders leaving 
short unprotected tails (maximum 5 positions) at the beginning and
at the end of the profile. One normalization mode is specified:
\fIn-score = raw-score / F\fP , where \fIF\fP is the output score multiplier
(\fIsee\fP below).   
.SH OPTIONS 
.TP
\-0
Global alignment mode; initiation (termination) at low cost
is possible only if the alignment starts at the beginning (end) of the 
profile and the sequence.
.TP
\-1
Domain global alignment mode; initiation (termination) at low cost
is possible only at the beginning (end) of the profile but at
any position in the sequence. 
.TP
\-2
Semi-global alignment mode; initiation (termination) at low cost
is possible if the alignment starts either at the beginning (end) of the 
profile or at the beginning (end) of the sequences. This is the 
default alignment mode.
.TP
\-3
Local alignment mode; initiation (termination) at low cost
is possible anywhere. The high-cost initiation/termination score
(parameter 
.I H)
is meaningless. 
.TP
\-a
Causes pfsearch to weight gaps asymmetrically, as in Gribskov et al. (1990).
.TP
\-b
Block profile mode. By imposing additional constraints on the placement of
insertions and deletions, this mode produces profiles that favor alignments
with insertions and deletions positioned symmetrically around a few 
positions. For each gap region a gap center is defined which
usually corresponds to the place where gap excision has been applied
(see parameter 
.I X).
If no gap excision has been applied, the position is chosen such as to 
maximize the sum of deletion opening events before, and  
and deletion closing events after the gap center.
Within a given gap region
reduced deletion opening penalties are offered only before,
reduced deletion closing penalties only after,
and reduced insertion penalties only at the center.
This option is incompatible with options 
.I -a
and
.I -e
and 
automatically disables them.
.TP
\-e
Enables endgap-weighting mode as implemented in the GCG program
.B ProfileMake.
Endgaps in the multiple sequence alignment will be interpreted
as deletions relative to the other sequences and thus be
considered for the delineation of gap regions. 
The default is no endgap weighting as introduced by Thompson et al. (1994) 
in the program
.B ProfileWeight.
.TP
\-s
Causes pfsearch to weight gaps symmetrically (default mode). The
initial gap opening scores 
.I (MD, MI)
computed from the 
maximal gap length and the command-line parameters 
.I E,G,I,
and 
.I M,
will be divided by two and the resulting value will be assigned to both 
gap opening and gap closing scores 
.I (MI, IM, MD, DM).
.SH PARAMETERS 
.TP
E=#
Gap extension penalty, \fIsee\fR Gribskov et al. (1990). Default: E=0.2 
(appropriate for 1/3 bit-scaled blosum45 matrix).  
.TP
F=#
Output score multiplier. On output, all profile scores are multiplied by
this factor and rounded to nearest integers. Default: F=100.
.TP
G=#
Gap opening penalty, \fIsee\fR Gribskov et al. (1990). Default: G=2.1
(appropriate for 1/3 bit-scaled blosum45 matrix).  
.TP
H=#
High-cost initiation/termination score. This score will be applied to
all external and internal initiation and termination scores corresponding
to path matrix positions where  
initiation or termination at low cost is not possible according to the alignment
mode specified. Default: H=* (low-value).
.TP
I=#
Gap penalty multiplier increment, \fIsee\fR Gribskov et al. (1990). 
Default: I=0.1.
.TP
L=#
Low-cost initiation/termination score. This score will be applied to
all external and internal initiation and termination scores corresponding
to path matrix positions where  
initiation or termination at low cost is possible according to the alignment
mode specified. Default: L=0.
.TP
M=#
Maximum gap penalty multiplier, \fIsee\fR Gribskov et al. (1990). 
Default: M=0.333.
.TP
S=#
Score matrix multiplier. On input, the numbers of the score matrix 
are multipled by this factor. Default: S=0.1.  
.TP
T=#
Gap region threshold. This is the minimal fraction of gap characters
a column of the multiple sequence alignment must contain 
in order to be considered part of a gap region. Default: T=0.01.
.TP
X=#
Gap excision threshold. This is the minimal fraction of non-gap characters
a column of the multiple sequence alignment must contain
in order to be converted into a match position. The 
.I IM
and 
.I MI 
transition scores of insert positions corresponding to excised columns
are set to zero; the other parameters remain unchanged.
Default: X=0.5.
.SH EXAMPLES
.TP
(1)
.B pfmake
-b1 sh3.msf blosum45.cmp H=0.6 > sh3_block.prf    

Generates a domain-global block profile from a multiple alignment
of SH3 domains using the blosum45 matrix. 
"sh3.seq" contains a multiple alignment of 20 SH3 domains from SWISS-PROT
release 32 including sequence weights. 
"blodsum45.cmp" contains a 1/3 bits-scaled blosum45 matrix in
GCG format.
Note that fragment matches (alignments to parts of the profile) are not 
prohibited but penalized by the parameter 
.I H=0.6. 
.SH REFERENCES
.LP
Bucher P, Karplus K, Moeri N & Hofmann, K. (1996).
.I A flexible motif search
.I technique based on generalized
.I profiles.
Comput. Chem. 
\fB20\fR:3-24.
.LP
Gribskov M, Luethy R & Eisenberg D (1990).
.I Profile analysis. 
Meth. Enzymol.
\fB183\fR:146-159.
.LP
Luethy R, Xenarios I & Bucher P (1994).
.I Improving the sensitivity of the
.I sequence profile method.
Prot. Sci. 
\fB3\fR:139-146.
.LP
Thompson JD, Higgins DG & Gibson TJ (1994)
.I Improved sensitivity of profile
.I searches through the 
.I use of sequence weights
.I and gap excision.  
Comput. Appl. Biosci.  
\fB10\fR:19-29.
.SH AUTHOR
Philipp Bucher
.br
pbucher@isrec-sun1.unil.ch
