.TH PFSCALE 1 "February 1998" "pftools 2.1"
.SH NAME
pfscale \- fit parameters of an extreme-value distribution to a profile score list 
.SH SYNOPSIS
.B pfscale
[ score-list | - ] [L=#] [N=#] [P=#] [Q=#] 
.SH DESCRIPTION
.B pfscale 
fits parameters of an extreme value to a score distribution obtained
by searching a sequence database with a profile. 
score-list is a sorted list of profile match scores generated by
.B pfsearch.
The result is written to the standard output.
Also included in the output is a new list of profile scores, 
showing original scores, normalized scores, and
corresponding log-cumulative frequencies next to each other.
.PP
Note that this program implements the significance estimation procedure for profile
match scores described in (Hofmann & Bucher 1995). 
It has been used for the calculation of the normalization parameters of 
all profiles in PROSITE. 
.SH PARAMETERS
.TP
L=#
Logarithmic base of the parameters of the estimated extreme-value 
distribution. 
The parameters reported by 
.B pfscale
are expressed as logarithms
and thus can be inserted directly into a linear normalization function
defined in a generalized profile.
Default: L=10.
.TP
N=#
Size of the database from which the input score list was derived.
The searched database is typically a shuffled version
of real protein or nucleotide sequence database.
Default: N=14147368 (size of SWISS-PROT release 30 and shuffled
derivatives of it).
.TP
P=#
Upper threshold of the probability range to which the extreme-value
distribution will be fitted. 
For instance; if N=10'000'000 and P=0.0001 (default value for P)
then profile match scores below rank 1000
in the sorted input list
(corresponding to occurrence probabilities > 0.0001)
will be ignored.
.TP
Q=#
Lower threshold of the probability range to which the extreme-value
distribution will be fitted. 
For instance: if N=10'000'000 and Q=0.000001 (default value for Q)
then profile match scores above rank 10 in the sorted input list
(corresponding to occurrence probabilities < 0.000001)
will be ignored.
.SH EXAMPLES
.TP
(1)
.B pfsearch
\-fr sh3.prf shuffle20.seq C=200 | sort -nr | 
.B pfscale
\-  
 
derives score-normalization parameters for the SH3 domain profile 
in "sh3.prf". 
"shuffle20.seq" contains a window-shuffled derivative of 
SWISS-PROT release 30 in Pearson/Fasta format (window-size 20). 
Note that the implicit default of 
.I N
corresponds to the size of this database and thus 
need not to be specified on the command line.
The cut-off value C=200 will produce about 2000 matches
completely covering the range defined by the default values
of
.I P
and 
.I Q.
A suitable cut-off value has to be guessed in advance 
by computing a few optimal alignment scores
for random sequences. 
.SH REFERENCES
.LP
Hofmann K & Bucher P (1995).
\fIThe FHA-domain: a nuclear signalling domain found in protein kinases and transcription factors.\fP 
Trends Biochem. Sci.
\fB20\fR:47-349. 
.SH AUTHOR
Philipp Bucher
.br
pbucher@isrec-sun1.unil.ch
